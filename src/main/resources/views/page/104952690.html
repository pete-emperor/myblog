<html>
<head>
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/detail-4bfa3af0c6.min.css">
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/themes/skin3-template/skin3-template-c9d2f651cc.min.css">
<link rel="stylesheet" href="https://csdnimg.cn/public/sandalstrap/1.4/css/sandalstrap.min.css">
<link rel="stylesheet" href="https://csdnimg.cn/public/common/toolbar/content_toolbar_css/content_toolbar.css">
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/blog_code-c3a0c33d5c.css">
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/vendor/pagination/paging-e040f0c7c8.css">
<style>
        .MathJax, .MathJax_Message, .MathJax_Preview{
            display: none
        }
    </style>
</head>
<body class="nodata " > 
    <link rel="stylesheet" href="https://csdnimg.cn/public/common/toolbar/content_toolbar_css/content_toolbar.css">
    <script id="toolbar-tpl-scriptId" src="https://csdnimg.cn/public/common/toolbar/js/content_toolbar.js" type="text/javascript" domain="https://blog.csdn.net/"></script>
    <script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/blog_code-c3a0c33d5c.css">
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/vendor/pagination/paging-e040f0c7c8.css">

<script type="text/javascript">
	var NEWS_FEED = function(){}
</script>

<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/chart-3456820cac.css" />
<div class="main_father clearfix d-flex justify-content-center" style="height:100%;"> 
    <div class="container clearfix" id="mainBox">
        <div  class='space_container'></div>
        <main>
            <div class="blog-content-box">
    <div class="article-header-box">
        <div class="article-header">
            <div class="article-title-box">
                <h1 class="title-article">Android 11 中的存储机制更新</h1>
            </div>
            <div class="article-info-box">
                <div class="article-bar-top">
                    <!--文章类型-->
                    <span class="article-type type-1 float-left">原创</span>                                                                                                                                            <a class="follow-nickName" href="https://me.csdn.net/weixin_43901866" target="_blank" rel="noopener">Android Developer</a>
                    <span class="time">最后发布于2020-03-18 20:24:29                    </span>
                    <span class="read-count">阅读数 19</span>
                    <a id='blog_detail_zk_collection' class="un-collection" data-report-click='{"mod":"popu_823"}'>
                        <svg class="icon">
                            <use xlink:href="#icon-csdnc-Collection-G" ></use>
                        </svg>
                        <span>收藏</span>
                    </a>
                                    </div>
                                <div class="up-time">发布于2020-03-18 20:24:29</div>
                <div class="slide-content-box">
                                                        <div class="tags-box artic-tag-box">
                           <span class="label">分类专栏：</span>
                                                                                             <a class="tag-link" target="_blank" rel="noopener"
                                      href="https://blog.csdn.net/weixin_43901866/category_9721804.html">
                                       技术                                   </a>
                                                                                  </div>
                                                                                           <div class="tags-box artic-tag-box">
                                <span class="label">文章标签：</span>
                                                                <a data-report-click='{"mod":"popu_626","strategy":"android"}' data-report-view='{"mod":"popu_626","strategy":"android"}' class="tag-link" href="https://so.csdn.net/so/search/s.do?q=android&t=blog" target="_blank" rel="noopener">android                                                                    <a data-report-click='{"mod":"popu_626","strategy":"Google"}' data-report-view='{"mod":"popu_626","strategy":"Google"}' class="tag-link" href="https://so.csdn.net/so/search/s.do?q=Google&t=blog" target="_blank" rel="noopener">Google                                                                    </a>
                            </div>
                                                                                                                <div class="article-copyright">
                        <span class="creativecommons">
                            <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"></a>
                            <span>
                                版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 BY-SA </a>版权协议，转载请附上原文出处链接和本声明。                            </span>
                            <div class="article-source-link2222">
                                本文链接：<a href="https://blog.csdn.net/weixin_43901866/article/details/104952690">https://blog.csdn.net/weixin_43901866/article/details/104952690</a>
                            </div>
                        </span> 
                        </div>
                                                                                </div>
                <div class="operating">
                                                                <a class="href-article-edit slide-toggle">展开</a>
                                    </div>
            </div>
        </div>
    </div>
    <article class="baidu_pl">
        <!--python安装手册开始-->
                <!--python安装手册结束-->
                <!--####专栏广告位图文切换开始-->
                                    <!--####专栏广告位图文切换结束-->
         <div id="article_content" class="article_content clearfix">
            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-833878f763.css" />
                            <div id="content_views" class="markdown_views prism-atom-one-dark">
                    <!-- flowchart 箭头图标 勿删 -->
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                                            <p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xODQ1MjUzNi0wYzdkN2NkZjRjNTA1Zjhh?x-oss-process=image/format,png" alt=""></p>
<p>Android 10 引入了对外部存储权限的更改，旨在更好地保护用户数据以及降低应用的存储空间。<a href="http://mp.weixin.qq.com/s?__biz=MzAwODY4OTk2Mg==&amp;mid=2652052404&amp;idx=1&amp;sn=b095bac592ee32a75153ece8e01361a1&amp;chksm=808cbbf1b7fb32e7a9d7ad36b99e7893cc360a8297e2f05a4b40322e6b77d9a7584e4650fcc2&amp;scene=21#wechat_redirect" rel="nofollow">Android 11 开发者预览版</a>里加入了更多改进，以帮助开发者更好地适应这些权限修改。</p>
<p>在 Google Play 上发布的大部分应用都会请求 (READ_EXTERNAL_STORAGE) 存储权限，来做一些诸如在 SD 卡中存储文件或者读取多媒体文件等常规操作。这些应用可能会在磁盘中存储大量文件，即使应用被卸载了还会依然存在。另外，这些应用还可能会读取其他应用的一些敏感文件数据。在 Android 10 中，我们调整了存储权限的工作方式，仅为应用提供其所需的访问权限。这也是在鼓励应用在指定目录下进行文件存储以限制文件混乱。当应用被卸载后，这些相关的目录也会被删除。</p>
<p>Android 10 所带来的关于存储上的变更遵循了以下三个基本原则</p>
<ul>
<li><strong>更好的从属性:</strong>&nbsp;系统知道哪些文件属于哪些应用，这可以让用户更方便地管理他们的文件。当应用被卸载后，除非用户需要，否则应用之前所创建的文件也不应该保留在设备上；</li>
<li>**保护应用数据:&nbsp;**当一个应用将它所属的文件写入外部存储时，这些文件是不应该被其他应用所访问的；</li>
<li>**保护用户数据:&nbsp;**当用户下载了一些文件，比如带有敏感信息的邮件附件，这些文件应该对其他应用不可见。</li>
</ul>
<p>目标 API 级别 (Target SDK Level) 设定为 Android 10 的应用无需请求 Storage 权限，就可以使用自己的外部存储目录并管理媒体集合 (音频、视频、图片和下载数据)。Storage 权限仅允许读取其他应用<strong>共享</strong>的音频、视频和图片集合，但并不允许访问非本应用创建的下载数据。在 Android 10 里唯一一种访问其他应用创建的非媒体文件的途径是使用存储访问框架 (Storage Access Framework)&nbsp;提供的文档选择器。</p>
<p>在 Android 11 中，我们会通过下述的几点来继续优化分区存储 (Scoped Storage) 的开发者体验。</p>
<ul>
<li>Android 10 对外部存储权限行为https://developer.android.google.cn/training/data-storage#scoped-storage</li>
<li>请求 (READ_EXTERNAL_STORAGE) 存储权限https://developer.android.google.cn/reference/android/Manifest.permission#READ_EXTERNAL_STORAGE</li>
<li>它所属的文件https://developer.android.google.cn/training/data-storage/app-specific</li>
<li>存储访问框架 (Storage Access Framework)https://developer.android.google.cn/guide/topics/providers/document-provider</li>
</ul>
<p><strong>改进媒体存储</strong></p>
<p>Android 10 中要求所有应用都使用 MediaStore API 来访问照片、视频和音乐文件，我们也将继续秉承这个原则。但是我们也知道，很多深度依赖基于原始文件路径 API 的应用和第三方库是很难切换到使用文件描述符 (File Descriptor) 的。因此在 Android 11 里，依赖原始文件路径的 API 和库可以再次使用了。您需要在应用的 Manifest 文件里添加 requestLegacyExternalStorage 属性，以保证 Android 10 的用户也可以使用该特性。在实际的运行中，依赖原始文件路径的 I/O 请求会被重定向到使用 MediaStore API，当使用这种方式访问本应用存储空间之外的文件时，这次重定向会造成性能影响。而且直接使用原始文件路径，并不会比使用 MediaStore API 有更多优势，因此我们强烈建议直接使用 MediaStore API。在 Android 10 中，应用在对每一个文件请求编辑或删除时都必须得到用户的确认。而在 Android 11 中，应用可以一次请求修改或者删除多个媒体文件。系统的默认图库应用 (Gallery) 将不再展示这些对话框。我们希望这项改进能够使用户体验更加顺畅。<img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xODQ1MjUzNi1hNjQ1OTc2ZDQ1MmIyMWU2?x-oss-process=image/format,png" alt="image"></p>
<ul>
<li>可以再次使用https://developer.android.google.cn/preview/privacy/storage#media-files-raw-paths</li>
<li>修改或者删除多个媒体文件https://developer.android.com/preview/privacy/storage#media-file-access</li>
</ul>
<p><strong>对 Storage Access Framework 的更新</strong></p>
<p>当我们对广泛的存储访问进行限制后，一些开发者试图使用 Storage Access Framework (SAF) 遍历整个文件系统。但是，SAF 并不适用于广泛地访问共享存储内容。因此，我们对其进行了更新，限制了它对某些路径的可见性。</p>
<p>在 Android 11 中，将不再允许用户授权访问 Downloads 的根目录、每个可用 SD 卡的根目录以及其它应用的目录。应用仍然可以通过 Storage Access Framework API 或者文件选择器来帮助用户从共享存储中选取个别文件。</p>
<ul>
<li>
<p>对其进行了更新</p>
<p>https://developer.android.google.cn/preview/privacy/storage#file-directory-restrictions</p>
</li>
</ul>
<p><strong>针对文件管理应用的特殊权限</strong></p>
<p>针对文件管理器以及一些备份类的应用，它们需要获得共享存储的更广泛的访问权限。Android 11 里将会引入一个特别的权限叫做&nbsp;<strong>MANAGE_EXTERNAL_STORAGE</strong>，该权限将授权读写所有共享存储内容，这也将同时包含非媒体类型的文件。但是获得这个权限的应用还是<strong>无法访问</strong>其他应用的应用专属目录 (app-specific directory)，无论是外部存储还是内部存储。</p>
<p>我们希望继续允许一些确实有广泛访问外部存储文件需求的应用。在 Android 11 中，已获得<strong>MANAGE_EXTERNAL_STORAGE</strong>&nbsp;权限的应用，可以将用户引导至系统设置页面，让用户选择是否允许该应用 “访问所有文件” (All Files Access)。下面的两种应用示例是可以使用该权限的:</p>
<ul>
<li>文件管理器 —— 该类应用的主要功能是管理文件；</li>
<li>备份和恢复 —— 该类应用需要访问大批量的文件&nbsp;(比如切换设备的时候进行数据迁移，或者将数据备份到云端)。</li>
</ul>
<p>如果您的应用需要访问单个文件，比如文字处理应用，则应该使用 Storage Access Framework (SAF)。</p>
<p>如果您的应用需要&nbsp;<strong>MANAGE_EXTERNAL_STORAGE</strong>&nbsp;权限或者调用了依赖原始文件路径的 API，那么您必须在 AndroidManifest 文件中添加&nbsp; requestLegacyExternalStorage=true，这样您的应用才能够在搭载 Android 10 的设备上正常运行。更多相关信息请查看我们在去年 Android 开发者峰会的分享视频《准备好使用分区存储》:</p>
<ul>
<li>
<p>腾讯视频链接</p>
<p>https://v.qq.com/x/page/d3026c1bpr3.html</p>
</li>
<li>
<p>Bilibili 视频链接</p>
<p>https://www.bilibili.com/video/av77198618/</p>
</li>
</ul>

                                    </div>
                <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-60ecaf1f42.css" rel="stylesheet">
                                                <div class="more-toolbox">
                <div class="left-toolbox">
                    <ul class="toolbox-list">
                        
                        <li class="tool-item tool-active is-like "><a href="javascript:;"><svg class="icon" aria-hidden="true">
                            <use xlink:href="#csdnc-thumbsup"></use>
                        </svg><span class="name">点赞</span>
                        <span class="count"></span>
                        </a></li>
                        <li class="tool-item tool-active is-collection "><a href="javascript:;" data-report-click='{"mod":"popu_824"}'><svg class="icon" aria-hidden="true">
                            <use xlink:href="#icon-csdnc-Collection-G" ></use>
                        </svg><span class="name">收藏</span></a></li>
                        <li class="tool-item tool-active is-share"><a href="javascript:;" data-report-click='{"mod":"1582594662_002"}'><svg class="icon" aria-hidden="true">
                            <use xlink:href="#icon-csdnc-fenxiang"></use>
                        </svg>分享</a></li>
                        <!--打赏开始-->
                                                <!--打赏结束-->
                                                <li class="tool-item tool-more">
                            <a>
                            <svg t="1575545411852" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5717" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style>
</head>
<body>
<div style="width:852px;margin:0 auto;">
<div class="blog-content-box">
    <div class="article-header-box">
        <div class="article-header">
            <div class="article-title-box">
                <h1 class="title-article">Android 11 中的存储机制更新</h1>
            </div>
            <div class="article-info-box">
                <div class="article-bar-top">
                    <!--文章类型-->
                    <span class="article-type type-1 float-left">原创</span>                                                                                                                                            <a class="follow-nickName" href="https://me.csdn.net/weixin_43901866" target="_blank" rel="noopener">Android Developer</a>
                    <span class="time">最后发布于2020-03-18 20:24:29                    </span>
                    <span class="read-count">阅读数 19</span>
                    <a id='blog_detail_zk_collection' class="un-collection" data-report-click='{"mod":"popu_823"}'>
                        <svg class="icon">
                            <use xlink:href="#icon-csdnc-Collection-G" ></use>
                        </svg>
                        <span>收藏</span>
                    </a>
                                    </div>
                                <div class="up-time">发布于2020-03-18 20:24:29</div>
                <div class="slide-content-box">
                                                        <div class="tags-box artic-tag-box">
                           <span class="label">分类专栏：</span>
                                                                                             <a class="tag-link" target="_blank" rel="noopener"
                                      href="https://blog.csdn.net/weixin_43901866/category_9721804.html">
                                       技术                                   </a>
                                                                                  </div>
                                                                                           <div class="tags-box artic-tag-box">
                                <span class="label">文章标签：</span>
                                                                <a data-report-click='{"mod":"popu_626","strategy":"android"}' data-report-view='{"mod":"popu_626","strategy":"android"}' class="tag-link" href="https://so.csdn.net/so/search/s.do?q=android&t=blog" target="_blank" rel="noopener">android                                                                    <a data-report-click='{"mod":"popu_626","strategy":"Google"}' data-report-view='{"mod":"popu_626","strategy":"Google"}' class="tag-link" href="https://so.csdn.net/so/search/s.do?q=Google&t=blog" target="_blank" rel="noopener">Google                                                                    </a>
                            </div>
                                                                                                                <div class="article-copyright">
                        <span class="creativecommons">
                            <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"></a>
                            <span>
                                版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 BY-SA </a>版权协议，转载请附上原文出处链接和本声明。                            </span>
                            <div class="article-source-link2222">
                                本文链接：<a href="https://blog.csdn.net/weixin_43901866/article/details/104952690">https://blog.csdn.net/weixin_43901866/article/details/104952690</a>
                            </div>
                        </span> 
                        </div>
                                                                                </div>
                <div class="operating">
                                                                <a class="href-article-edit slide-toggle">展开</a>
                                    </div>
            </div>
        </div>
    </div>
    <article class="baidu_pl">
        <!--python安装手册开始-->
                <!--python安装手册结束-->
                <!--####专栏广告位图文切换开始-->
                                    <!--####专栏广告位图文切换结束-->
         <div id="article_content" class="article_content clearfix">
            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-833878f763.css" />
                            <div id="content_views" class="markdown_views prism-atom-one-dark">
                    <!-- flowchart 箭头图标 勿删 -->
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                                            <p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xODQ1MjUzNi0wYzdkN2NkZjRjNTA1Zjhh?x-oss-process=image/format,png" alt=""></p>
<p>Android 10 引入了对外部存储权限的更改，旨在更好地保护用户数据以及降低应用的存储空间。<a href="http://mp.weixin.qq.com/s?__biz=MzAwODY4OTk2Mg==&amp;mid=2652052404&amp;idx=1&amp;sn=b095bac592ee32a75153ece8e01361a1&amp;chksm=808cbbf1b7fb32e7a9d7ad36b99e7893cc360a8297e2f05a4b40322e6b77d9a7584e4650fcc2&amp;scene=21#wechat_redirect" rel="nofollow">Android 11 开发者预览版</a>里加入了更多改进，以帮助开发者更好地适应这些权限修改。</p>
<p>在 Google Play 上发布的大部分应用都会请求 (READ_EXTERNAL_STORAGE) 存储权限，来做一些诸如在 SD 卡中存储文件或者读取多媒体文件等常规操作。这些应用可能会在磁盘中存储大量文件，即使应用被卸载了还会依然存在。另外，这些应用还可能会读取其他应用的一些敏感文件数据。在 Android 10 中，我们调整了存储权限的工作方式，仅为应用提供其所需的访问权限。这也是在鼓励应用在指定目录下进行文件存储以限制文件混乱。当应用被卸载后，这些相关的目录也会被删除。</p>
<p>Android 10 所带来的关于存储上的变更遵循了以下三个基本原则</p>
<ul>
<li><strong>更好的从属性:</strong>&nbsp;系统知道哪些文件属于哪些应用，这可以让用户更方便地管理他们的文件。当应用被卸载后，除非用户需要，否则应用之前所创建的文件也不应该保留在设备上；</li>
<li>**保护应用数据:&nbsp;**当一个应用将它所属的文件写入外部存储时，这些文件是不应该被其他应用所访问的；</li>
<li>**保护用户数据:&nbsp;**当用户下载了一些文件，比如带有敏感信息的邮件附件，这些文件应该对其他应用不可见。</li>
</ul>
<p>目标 API 级别 (Target SDK Level) 设定为 Android 10 的应用无需请求 Storage 权限，就可以使用自己的外部存储目录并管理媒体集合 (音频、视频、图片和下载数据)。Storage 权限仅允许读取其他应用<strong>共享</strong>的音频、视频和图片集合，但并不允许访问非本应用创建的下载数据。在 Android 10 里唯一一种访问其他应用创建的非媒体文件的途径是使用存储访问框架 (Storage Access Framework)&nbsp;提供的文档选择器。</p>
<p>在 Android 11 中，我们会通过下述的几点来继续优化分区存储 (Scoped Storage) 的开发者体验。</p>
<ul>
<li>Android 10 对外部存储权限行为https://developer.android.google.cn/training/data-storage#scoped-storage</li>
<li>请求 (READ_EXTERNAL_STORAGE) 存储权限https://developer.android.google.cn/reference/android/Manifest.permission#READ_EXTERNAL_STORAGE</li>
<li>它所属的文件https://developer.android.google.cn/training/data-storage/app-specific</li>
<li>存储访问框架 (Storage Access Framework)https://developer.android.google.cn/guide/topics/providers/document-provider</li>
</ul>
<p><strong>改进媒体存储</strong></p>
<p>Android 10 中要求所有应用都使用 MediaStore API 来访问照片、视频和音乐文件，我们也将继续秉承这个原则。但是我们也知道，很多深度依赖基于原始文件路径 API 的应用和第三方库是很难切换到使用文件描述符 (File Descriptor) 的。因此在 Android 11 里，依赖原始文件路径的 API 和库可以再次使用了。您需要在应用的 Manifest 文件里添加 requestLegacyExternalStorage 属性，以保证 Android 10 的用户也可以使用该特性。在实际的运行中，依赖原始文件路径的 I/O 请求会被重定向到使用 MediaStore API，当使用这种方式访问本应用存储空间之外的文件时，这次重定向会造成性能影响。而且直接使用原始文件路径，并不会比使用 MediaStore API 有更多优势，因此我们强烈建议直接使用 MediaStore API。在 Android 10 中，应用在对每一个文件请求编辑或删除时都必须得到用户的确认。而在 Android 11 中，应用可以一次请求修改或者删除多个媒体文件。系统的默认图库应用 (Gallery) 将不再展示这些对话框。我们希望这项改进能够使用户体验更加顺畅。<img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xODQ1MjUzNi1hNjQ1OTc2ZDQ1MmIyMWU2?x-oss-process=image/format,png" alt="image"></p>
<ul>
<li>可以再次使用https://developer.android.google.cn/preview/privacy/storage#media-files-raw-paths</li>
<li>修改或者删除多个媒体文件https://developer.android.com/preview/privacy/storage#media-file-access</li>
</ul>
<p><strong>对 Storage Access Framework 的更新</strong></p>
<p>当我们对广泛的存储访问进行限制后，一些开发者试图使用 Storage Access Framework (SAF) 遍历整个文件系统。但是，SAF 并不适用于广泛地访问共享存储内容。因此，我们对其进行了更新，限制了它对某些路径的可见性。</p>
<p>在 Android 11 中，将不再允许用户授权访问 Downloads 的根目录、每个可用 SD 卡的根目录以及其它应用的目录。应用仍然可以通过 Storage Access Framework API 或者文件选择器来帮助用户从共享存储中选取个别文件。</p>
<ul>
<li>
<p>对其进行了更新</p>
<p>https://developer.android.google.cn/preview/privacy/storage#file-directory-restrictions</p>
</li>
</ul>
<p><strong>针对文件管理应用的特殊权限</strong></p>
<p>针对文件管理器以及一些备份类的应用，它们需要获得共享存储的更广泛的访问权限。Android 11 里将会引入一个特别的权限叫做&nbsp;<strong>MANAGE_EXTERNAL_STORAGE</strong>，该权限将授权读写所有共享存储内容，这也将同时包含非媒体类型的文件。但是获得这个权限的应用还是<strong>无法访问</strong>其他应用的应用专属目录 (app-specific directory)，无论是外部存储还是内部存储。</p>
<p>我们希望继续允许一些确实有广泛访问外部存储文件需求的应用。在 Android 11 中，已获得<strong>MANAGE_EXTERNAL_STORAGE</strong>&nbsp;权限的应用，可以将用户引导至系统设置页面，让用户选择是否允许该应用 “访问所有文件” (All Files Access)。下面的两种应用示例是可以使用该权限的:</p>
<ul>
<li>文件管理器 —— 该类应用的主要功能是管理文件；</li>
<li>备份和恢复 —— 该类应用需要访问大批量的文件&nbsp;(比如切换设备的时候进行数据迁移，或者将数据备份到云端)。</li>
</ul>
<p>如果您的应用需要访问单个文件，比如文字处理应用，则应该使用 Storage Access Framework (SAF)。</p>
<p>如果您的应用需要&nbsp;<strong>MANAGE_EXTERNAL_STORAGE</strong>&nbsp;权限或者调用了依赖原始文件路径的 API，那么您必须在 AndroidManifest 文件中添加&nbsp; requestLegacyExternalStorage=true，这样您的应用才能够在搭载 Android 10 的设备上正常运行。更多相关信息请查看我们在去年 Android 开发者峰会的分享视频《准备好使用分区存储》:</p>
<ul>
<li>
<p>腾讯视频链接</p>
<p>https://v.qq.com/x/page/d3026c1bpr3.html</p>
</li>
<li>
<p>Bilibili 视频链接</p>
<p>https://www.bilibili.com/video/av77198618/</p>
</li>
</ul>

                                    </div>
                <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-60ecaf1f42.css" rel="stylesheet">
                                                <div class="more-toolbox">
                <div class="left-toolbox">
                    <ul class="toolbox-list">
                        
                        <li class="tool-item tool-active is-like "><a href="javascript:;"><svg class="icon" aria-hidden="true">
                            <use xlink:href="#csdnc-thumbsup"></use>
                        </svg><span class="name">点赞</span>
                        <span class="count"></span>
                        </a></li>
                        <li class="tool-item tool-active is-collection "><a href="javascript:;" data-report-click='{"mod":"popu_824"}'><svg class="icon" aria-hidden="true">
                            <use xlink:href="#icon-csdnc-Collection-G" ></use>
                        </svg><span class="name">收藏</span></a></li>
                        <li class="tool-item tool-active is-share"><a href="javascript:;" data-report-click='{"mod":"1582594662_002"}'><svg class="icon" aria-hidden="true">
                            <use xlink:href="#icon-csdnc-fenxiang"></use>
                        </svg>分享</a></li>
                        <!--打赏开始-->
                                                <!--打赏结束-->
                                                <li class="tool-item tool-more">
                            <a>
                            <svg t="1575545411852" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5717" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M179.176 499.222m-113.245 0a113.245 113.245 0 1 0 226.49 0 113.245 113.245 0 1 0-226.49 0Z" p-id="5718"></path><path d="M509.684 499.222m-113.245 0a113.245 113.245 0 1 0 226.49 0 113.245 113.245 0 1 0-226.49 0Z" p-id="5719"></path><path d="M846.175 499.222m-113.245 0a113.245 113.245 0 1 0 226.49 0 113.245 113.245 0 1 0-226.49 0Z" p-id="5720"></path></svg>
                            </a>
                            <ul class="more-box">
                                <li class="item"><a class="article-report">文章举报</a></li>
                            </ul>
                        </li>
                                            </ul>
                </div>
                            </div>
            <div class="person-messagebox">
                <div class="left-message"><a href="https://blog.csdn.net/weixin_43901866">
                    <img src="https://profile.csdnimg.cn/8/2/E/3_weixin_43901866" class="avatar_pic" username='weixin_43901866'>
                                            <img src="https://g.csdnimg.cn/static/user-reg-year/1x/1.png" class="user-years">
                                    </a></div>
                <div class="middle-message">
                                        <div class="title"><span class="tit"><a href="https://blog.csdn.net/weixin_43901866" data-report-click='{"mod":"popu_379"}' target="_blank">Android Developer</a></span>
                                            </div>
                    <div class="text"><span>发布了450 篇原创文章</span> · <span>获赞 730</span> · <span>访问量 20万+</span></div>
                </div>
                                <div class="right-message">
                                            <a href="https://bbs.csdn.net/topics/395532450" target="_blank"
                        class="btn btn-sm btn-red-hollow bt-button personal-messageboard">他的留言板
                        </a>
                                                            <a class="btn btn-sm  bt-button personal-watch" data-report-click='{"mod":"popu_379"}'>关注</a>
                                    </div>
                            </div>
                    </div>
    </article>
</div>
</div>
</body>
</html>
