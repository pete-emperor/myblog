<html>
<head>
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/detail-4bfa3af0c6.min.css">
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/themes/skin3-template/skin3-template-c9d2f651cc.min.css">
<link rel="stylesheet" href="https://csdnimg.cn/public/sandalstrap/1.4/css/sandalstrap.min.css">
<link rel="stylesheet" href="https://csdnimg.cn/public/common/toolbar/content_toolbar_css/content_toolbar.css">
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/blog_code-c3a0c33d5c.css">
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/vendor/pagination/paging-e040f0c7c8.css">
<style>
        .MathJax, .MathJax_Message, .MathJax_Preview{
            display: none
        }
    </style>
</head>
<body class="nodata " > 
    <link rel="stylesheet" href="https://csdnimg.cn/public/common/toolbar/content_toolbar_css/content_toolbar.css">
    <script id="toolbar-tpl-scriptId" src="https://csdnimg.cn/public/common/toolbar/js/content_toolbar.js" type="text/javascript" domain="https://blog.csdn.net/"></script>
    <script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/blog_code-c3a0c33d5c.css">
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/vendor/pagination/paging-e040f0c7c8.css">

<script type="text/javascript">
	var NEWS_FEED = function(){}
</script>

<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/chart-3456820cac.css" />
<div class="main_father clearfix d-flex justify-content-center" style="height:100%;"> 
    <div class="container clearfix" id="mainBox">
        <div  class='space_container'></div>
        <main>
            <div class="blog-content-box">
    <div class="article-header-box">
        <div class="article-header">
            <div class="article-title-box">
                <h1 class="title-article">大学毕业做音视频开发，月入20K，你呢？</h1>
            </div>
            <div class="article-info-box">
                <div class="article-bar-top">
                    <!--文章类型-->
                    <span class="article-type type-1 float-left">原创</span>                                                                                                                                            <a class="follow-nickName" href="https://me.csdn.net/weixin_43901866" target="_blank" rel="noopener">Android Developer</a>
                    <span class="time">最后发布于2020-03-13 20:01:33                    </span>
                    <span class="read-count">阅读数 21</span>
                    <a id='blog_detail_zk_collection' class="un-collection" data-report-click='{"mod":"popu_823"}'>
                        <svg class="icon">
                            <use xlink:href="#icon-csdnc-Collection-G" ></use>
                        </svg>
                        <span>收藏</span>
                    </a>
                                    </div>
                                <div class="up-time">发布于2020-03-13 20:01:33</div>
                <div class="slide-content-box">
                                                        <div class="tags-box artic-tag-box">
                           <span class="label">分类专栏：</span>
                                                                                             <a class="tag-link" target="_blank" rel="noopener"
                                      href="https://blog.csdn.net/weixin_43901866/category_9337526.html">
                                       阿里                                   </a>
                                                                                                                            <a class="tag-link" target="_blank" rel="noopener"
                                      href="https://blog.csdn.net/weixin_43901866/category_9416379.html">
                                       Android                                   </a>
                                                                                                                            <a class="tag-link" target="_blank" rel="noopener"
                                      href="https://blog.csdn.net/weixin_43901866/category_9584164.html">
                                       京东                                   </a>
                                                                                  </div>
                                                                                                           <div class="article-copyright">
                        <span class="creativecommons">
                            <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"></a>
                            <span>
                                版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 BY-SA </a>版权协议，转载请附上原文出处链接和本声明。                            </span>
                            <div class="article-source-link2222">
                                本文链接：<a href="https://blog.csdn.net/weixin_43901866/article/details/104848230">https://blog.csdn.net/weixin_43901866/article/details/104848230</a>
                            </div>
                        </span> 
                        </div>
                                                                                </div>
                <div class="operating">
                                                                <a class="href-article-edit slide-toggle">展开</a>
                                    </div>
            </div>
        </div>
    </div>
    <article class="baidu_pl">
        <!--python安装手册开始-->
                <!--python安装手册结束-->
                <!--####专栏广告位图文切换开始-->
                                    <!--####专栏广告位图文切换结束-->
         <div id="article_content" class="article_content clearfix">
            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-833878f763.css" />
                            <div id="content_views" class="markdown_views prism-atom-one-dark">
                    <!-- flowchart 箭头图标 勿删 -->
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                                            <h1><a id="_0"></a>音视频趋势</h1>
<p>随着5G时代的到来，音视频领域将会大放异彩。</p>
<p>5G让所有人兴奋，用户期待，因为5G网络更快更稳定延迟更低。运营商和上下游产业也期待，大家都想在5G时代分一杯羹。</p>
<p>近几年抖音快手B站等App的火热，已经说明问题了。随着WiFi设施的全面普及，流量费用的进一步下降，使得我们随时随地刷视频成为了可能。回想起我大学时代，那个时候流量很贵，贵到什么程度呢？1M流量要10块钱！大家想一想，1M流量10块钱，1G流量1万块钱，你还敢用4G刷视频么？4G时代，大家刷短视频，5G时代，大家刷长视频。基于这个判断，音视频相关技术是未来几年的热点，除了抖音快手，新的现象级客户端有可能会出现。</p>
<p><strong>作为移动开发人员，如何跟上热点学习音视频技术呢？</strong></p>
<p>今天主要介绍视频入门基础知识</p>
<h1><a id="_11"></a>视频编码基础知识</h1>
<h4><a id="_13"></a>视频和图像和关系</h4>
<p>好了，刚才说了图像，现在，我们开始说视频。所谓视频，大家从小就看动画，都知道视频是怎么来的吧？没错，大量的图片连续起来，就是视频。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTZmMmIxNzJjOWUyMGJkM2QuZ2lmP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNDAwL2Zvcm1hdC93ZWJw" alt=""></p>
<p>衡量视频，又是用的什么指标参数呢？最主要的一个，就是帧率（Frame Rate）。在视频中，一个帧（Frame）就是指一幅静止的画面。帧率，就是指视频每秒钟包括的画面数量（FPS，Frame per second）。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTVkNThhNzk0N2M3YTUzNWMuZ2lmP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNTQyL2Zvcm1hdC93ZWJw" alt=""></p>
<p>帧率越高，视频就越逼真、越流畅。</p>
<h4><a id="_25"></a>未经编码的视频数据量会有多大？</h4>
<p><strong>有了视频之后，就涉及到两个问题：</strong></p>
<blockquote>
<p>一个是存储；</p>
<p>二个是传输。</p>
</blockquote>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTEwZTExODUxZmEwOTQ4NWUuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvMjkyL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>而之所以会有视频编码，关键就在于此：一个视频，如果未经编码，它的体积是非常庞大的。</p>
<p><strong>以一个分辨率1920×1280，帧率30的视频为例：</strong></p>
<blockquote>
<p>共：1920×1280=2,073,600（Pixels 像素），每个像素点是24bit（前面算过的哦）；</p>
<p>也就是：每幅图片2073600×24=49766400 bit，8 bit（位）=1 byte（字节）；</p>
<p>所以：49766400bit=6220800byte≈6.22MB。</p>
</blockquote>
<p>这是一幅1920×1280图片的原始大小，再乘以帧率30。</p>
<p>**也就是说：**每秒视频的大小是186.6MB，每分钟大约是11GB，一部90分钟的电影，约是1000GB。。。</p>
<p>吓尿了吧？就算你现在电脑硬盘是4TB的（实际也就3600GB），也放不下几部大姐姐啊！不仅要存储，还要传输，不然视频从哪来呢？如果按照100M的网速（12.5MB/s），下刚才那部电影，需要22个小时。。。再次崩溃。。。</p>
<p>正因为如此，屌丝工程师们就提出了，必须对视频进行编码。</p>
<h4><a id="_53"></a>什么是编码？</h4>
<p>**编码：**就是按指定的方法，将信息从一种形式（格式），转换成另一种形式（格式）。**视频编码：**就是将一种视频格式，转换成另一种视频格式。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWRmMmM1NTQ4ZWQ5OWFmNzAuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNTAwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>编码的终极目的，说白了，就是为了压缩。各种五花八门的视频编码方式，都是为了让视频变得体积更小，有利于存储和传输。</p>
<p><strong>我们先来看看，视频从录制到播放的整个过程，如下：</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTY2YWU5OGZmZGEwNzkyODUuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNzAwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>首先是视频采集。通常我们会使用摄像机、摄像头进行视频采集。限于篇幅，我就不打算和大家解释CCD成像原理了。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWMzZTdkOTRjM2ZmNDZjNTkuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNTAwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>采集了视频数据之后，就要进行模数转换，将模拟信号变成数字信号。其实现在很多都是摄像机（摄像头）直接输出数字信号。信号输出之后，还要进行预处理，将RGB信号变成YUV信号。</p>
<p><em><strong>前面我们介绍了RGB信号，那什么是YUV信号呢？</strong></em></p>
<p>简单来说，YUV就是另外一种颜色数字化表示方式。视频通信系统之所以要采用YUV，而不是RGB，主要是因为<strong>RGB信号不利于压缩</strong>。在YUV这种方式里面，加入了亮度这一概念。在最近十年中，视频工程师发现，眼睛对于亮和暗的分辨要比对颜色的分辨更精细一些，也就是说，人眼对色度的敏感程度要低于对亮度的敏感程度。</p>
<p>所以，工程师认为，在我们的视频存储中，没有必要存储全部颜色信号。我们可以把更多带宽留给黑—白信号（被称作“亮度”），将稍少的带宽留给彩色信号（被称作“色度”）。于是，就有了YUV。</p>
<p>YUV里面的“Y”，就是亮度（Luma），“U”和“V”则是色度（Chroma）。</p>
<p>大家偶尔会见到的Y’CbCr，也称为YUV，是YUV的压缩版本，不同之处在于Y’CbCr用于数字图像领域，YUV用于模拟信号领域，MPEG、DVD、摄像机中常说的YUV其实就是Y’CbCr。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTIxY2ZlMDc4MGRhZWQyMjEuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNjAwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt="image"></p>
<p>▲ YUV（Y’CbCr）是如何形成图像的</p>
<p>YUV码流的存储格式其实与其采样的方式密切相关。（采样，就是捕捉数据）</p>
<p><strong>主流的采样方式有三种：</strong></p>
<blockquote>
<p>1）YUV4:4:4；</p>
<p>2）YUV4:2:2；</p>
<p>3）YUV4:2:0。</p>
</blockquote>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWE1NjJhNmI1YmQ2NDY3NzcuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNTgwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt="image"></p>
<p>具体解释起来有点繁琐，大家只需记住，通常用的是YUV4:2:0的采样方式，能获得1/2的压缩率。</p>
<p>这些预处理做完之后，就是正式的编码了。</p>

<h1><a id="5_103"></a>5、视频编码的实现原理</h1>
<h4><a id="51__105"></a>5.1 视频编码技术的基本原理</h4>
<p>前面我们说了，编码就是为了压缩。要实现压缩，就要设计各种算法，将视频数据中的冗余信息去除。当你面对一张图片，或者一段视频的时候，你想一想，如果是你，你会如何进行压缩呢？</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWNlMGFlMDMyYzRkZTBjODkuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNDUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>▲ 对于新垣女神，我一bit也不舍得压缩…</p>
<p>我觉得，首先你想到的，应该是找规律。是的，寻找像素之间的相关性，还有不同时间的图像帧之间，它们的相关性。</p>
<p>**举个例子：**如果一幅图（1920×1080分辨率），全是红色的，我有没有必要说2073600次[255,0,0]？我只要说一次[255,0,0]，然后再说2073599次“同上”。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LThiNTQ2ZDlmOWYzMjI2ODcuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvMjUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>如果一段1分钟的视频，有十几秒画面是不动的，或者，有80%的图像面积，整个过程都是不变（不动）的。那么，是不是这块存储开销，就可以节约掉了？</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTkxMmMxYjJkZThlMWM0OWMuZ2lmP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNTAwL2Zvcm1hdC93ZWJw" alt=""></p>
<p>▲ 以上图为例，只有部分元素在动，大部分是不动的</p>
<p>是的，所谓编码算法，就是寻找规律，构建模型。谁能找到更精准的规律，建立更高效的模型，谁就是厉害的算法。</p>
<p><strong>通常来说，视频里面的冗余信息包括：</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTBiZTAyNTE3MjRjYjYyMzkuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNTk5L2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTk3NzFmYTQ2MWYzM2I4YjguanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNDEyL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>视频编码技术优先消除的目标，就是空间冗余和时间冗余。</p>
<p>接下来，就和大家介绍一下，究竟是采用什么样的办法，才能干掉它们。以下内容稍微有点高能，不过我相信大家耐心一些还是可以看懂的。</p>
<h4><a id="_137"></a>视频编码技术的实现方法</h4>
<p>视频是由不同的帧画面连续播放形成的。</p>
<p><strong>这些帧，主要分为三类，分别是：</strong></p>
<blockquote>
<p>1）I帧；</p>
<p>2）B帧；</p>
<p>3）P帧。</p>
</blockquote>
<p>**I帧：**是自带全部信息的独立帧，是最完整的画面（占用的空间最大），无需参考其它图像便可独立进行解码。视频序列中的第一个帧，始终都是I帧。</p>
<p><strong>P帧：</strong>“帧间预测编码帧”，需要参考前面的I帧和/或P帧的不同部分，才能进行编码。P帧对前面的P和I参考帧有依赖性。但是，P帧压缩率比较高，占用的空间较小。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTBiMGM5MGQyZTNhZTJjYWQuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvMzYwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>▲ P帧</p>
<p><strong>B帧：</strong>“双向预测编码帧”，以前帧后帧作为参考帧。不仅参考前面，还参考后面的帧，所以，它的压缩率最高，可以达到200:1。不过，因为依赖后面的帧，所以不适合实时传输（例如视频会议）。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWVhNWZhN2U2ZjJkNjU1NmQuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNDA4L2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>▲ B帧</p>
<p>通过对帧的分类处理，可以大幅压缩视频的大小。毕竟，要处理的对象，大幅减少了（从整个图像，变成图像中的一个区域）。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTdmNWQ5ZjI4MDQ5MzRlMjcuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNjAwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p><strong>如果从视频码流中抓一个包，也可以看到I帧的信息，如下：</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWM4YzZkNTkzOGNkMDU1MTEuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNzUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>我们来通过一个例子看一下。</p>
<p><strong>这有两个帧：</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTRhYzJkZGE4ODExMDk2YWUuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvODAwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>好像是一样的？</p>
<p><strong>不对，我做个GIF动图，就能看出来，是不一样的：</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWFlZTMzZDFiNTIwZDRkMDYuZ2lmP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNjQwL2Zvcm1hdC93ZWJw" alt=""></p>
<p>人在动，背景是没有在动的。</p>
<p><strong>第一帧是I帧，第二帧是P帧。两个帧之间的差值，就是如下：</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTYyYjg1MjRkYzM3NGEzM2YuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvMzUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p><strong>也就是说，图中的部分像素，进行了移动。移动轨迹如下：</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LThhMTdmYjA5NTY1ZjczYjMuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvMzUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>这个，就是运动估计和补偿。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTZhYTNkODZlOWIwYzVhYmIuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNjUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>当然了，如果总是按照像素来算，数据量会比较大，所以，一般都是把图像切割为不同的“块（Block）”或“宏块（MacroBlock）”，对它们进行计算。一个宏块一般为16像素×16像素。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWFiMjdkM2E2OTA0ZjI4N2IuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNTcxL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>▲ 将图片切割为宏块</p>
<p>好了，我来梳理一下。</p>
<p>对I帧的处理，是采用帧内编码方式，只利用本帧图像内的空间相关性。对P帧的处理，采用帧间编码（前向运动估计），同时利用空间和时间上的相关性。简单来说，采用运动补偿(motion compensation)算法来去掉冗余信息。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTkyMzJhYjI1ZWVlNGY0NTEuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNDMxL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>需要特别注意，I帧（帧内编码），虽然只有空间相关性，但整个编码过程也不简单。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWZkM2Y1N2MzM2NjYjlkOTYuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNDUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>如上图所示，整个帧内编码，还要经过DCT（离散余弦变换）、量化、编码等多个过程。限于篇幅，加之较为复杂，今天就放弃解释了。</p>
<p>那么，视频经过编码解码之后，如何衡量和评价编解码的效果呢？</p>
<p>一般来说，分为客观评价和主观评价。客观评价，就是拿数字来说话。例如计算“信噪比/峰值信噪比”。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTg5ZmY1ZjllOWZlN2VjMTguanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNjUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>信噪比的计算，我就不介绍了，丢个公式，有空可以自己慢慢研究…</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWRkNzkwNmZhNzRiODA4NzkuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNDUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>除了客观评价，就是主观评价了。主观评价，就是用人的主观感知直接测量，额，说人话就是——“好不好看我说了算”。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTRlOTBlNzdkMjgxM2Y0MWEuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNDUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p><strong>学习分享</strong></p>
<p>音视频，人工智能，这些是未来没办法阻挡的发展大趋势。我在猎聘网上看那些招聘岗位，要求精通NDK的薪资都在30-60K。追求高薪岗位的小伙伴，NDK开发一定要掌握并且去深挖。</p>
<p>题外话，虽然我在大厂工作多年，但也指导过不少同行。深知学习分享的重要性。</p>
<p>当程序员容易，当一个优秀的程序员是需要不断学习的，从初级程序员到高级程序员，从初级架构师到资深架构师，或者走向管理，从技术经理到技术总监，每个阶段都需要掌握不同的能力。早早确定自己的职业方向，才能在工作和能力提升中甩开同龄人。</p>
<p><strong>以下是今天给大家分享的一些独家干货：</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xOTk1NjEyNy0zNTBlYjRhNTAxNjlkMzg1LnBuZw?x-oss-process=image/format,png" alt=""></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xOTk1NjEyNy0wNDc5YTJiZThhYTM1OTQwLnBuZw?x-oss-process=image/format,png" alt=""></p>
<p><strong>【Android高级架构思维脑图（技能树）】</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xOTk1NjEyNy1lYjllNzQ5OGY3ZTY2NDFjLnBuZw?x-oss-process=image/format,png" alt=""></p>
<p><strong>【NDK学习视频】、【NDK资料包】【私信我】查看免费领取方式！</strong></p>

                                    </div>
                <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-60ecaf1f42.css" rel="stylesheet">
                                                <div class="more-toolbox">
                <div class="left-toolbox">
                    <ul class="toolbox-list">
                        
                        <li class="tool-item tool-active is-like "><a href="javascript:;"><svg class="icon" aria-hidden="true">
                            <use xlink:href="#csdnc-thumbsup"></use>
                        </svg><span class="name">点赞</span>
                        <span class="count"></span>
                        </a></li>
                        <li class="tool-item tool-active is-collection "><a href="javascript:;" data-report-click='{"mod":"popu_824"}'><svg class="icon" aria-hidden="true">
                            <use xlink:href="#icon-csdnc-Collection-G" ></use>
                        </svg><span class="name">收藏</span></a></li>
                        <li class="tool-item tool-active is-share"><a href="javascript:;" data-report-click='{"mod":"1582594662_002"}'><svg class="icon" aria-hidden="true">
                            <use xlink:href="#icon-csdnc-fenxiang"></use>
                        </svg>分享</a></li>
                        <!--打赏开始-->
                                                <!--打赏结束-->
                                                <li class="tool-item tool-more">
                            <a>
                            <svg t="1575545411852" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5717" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style>
</head>
<body>
<div style="width:852px;margin:0 auto;">
<div class="blog-content-box">
    <div class="article-header-box">
        <div class="article-header">
            <div class="article-title-box">
                <h1 class="title-article">大学毕业做音视频开发，月入20K，你呢？</h1>
            </div>
            <div class="article-info-box">
                <div class="article-bar-top">
                    <!--文章类型-->
                    <span class="article-type type-1 float-left">原创</span>                                                                                                                                            <a class="follow-nickName" href="https://me.csdn.net/weixin_43901866" target="_blank" rel="noopener">Android Developer</a>
                    <span class="time">最后发布于2020-03-13 20:01:33                    </span>
                    <span class="read-count">阅读数 21</span>
                    <a id='blog_detail_zk_collection' class="un-collection" data-report-click='{"mod":"popu_823"}'>
                        <svg class="icon">
                            <use xlink:href="#icon-csdnc-Collection-G" ></use>
                        </svg>
                        <span>收藏</span>
                    </a>
                                    </div>
                                <div class="up-time">发布于2020-03-13 20:01:33</div>
                <div class="slide-content-box">
                                                        <div class="tags-box artic-tag-box">
                           <span class="label">分类专栏：</span>
                                                                                             <a class="tag-link" target="_blank" rel="noopener"
                                      href="https://blog.csdn.net/weixin_43901866/category_9337526.html">
                                       阿里                                   </a>
                                                                                                                            <a class="tag-link" target="_blank" rel="noopener"
                                      href="https://blog.csdn.net/weixin_43901866/category_9416379.html">
                                       Android                                   </a>
                                                                                                                            <a class="tag-link" target="_blank" rel="noopener"
                                      href="https://blog.csdn.net/weixin_43901866/category_9584164.html">
                                       京东                                   </a>
                                                                                  </div>
                                                                                                           <div class="article-copyright">
                        <span class="creativecommons">
                            <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"></a>
                            <span>
                                版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 BY-SA </a>版权协议，转载请附上原文出处链接和本声明。                            </span>
                            <div class="article-source-link2222">
                                本文链接：<a href="https://blog.csdn.net/weixin_43901866/article/details/104848230">https://blog.csdn.net/weixin_43901866/article/details/104848230</a>
                            </div>
                        </span> 
                        </div>
                                                                                </div>
                <div class="operating">
                                                                <a class="href-article-edit slide-toggle">展开</a>
                                    </div>
            </div>
        </div>
    </div>
    <article class="baidu_pl">
        <!--python安装手册开始-->
                <!--python安装手册结束-->
                <!--####专栏广告位图文切换开始-->
                                    <!--####专栏广告位图文切换结束-->
         <div id="article_content" class="article_content clearfix">
            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-833878f763.css" />
                            <div id="content_views" class="markdown_views prism-atom-one-dark">
                    <!-- flowchart 箭头图标 勿删 -->
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                                            <h1><a id="_0"></a>音视频趋势</h1>
<p>随着5G时代的到来，音视频领域将会大放异彩。</p>
<p>5G让所有人兴奋，用户期待，因为5G网络更快更稳定延迟更低。运营商和上下游产业也期待，大家都想在5G时代分一杯羹。</p>
<p>近几年抖音快手B站等App的火热，已经说明问题了。随着WiFi设施的全面普及，流量费用的进一步下降，使得我们随时随地刷视频成为了可能。回想起我大学时代，那个时候流量很贵，贵到什么程度呢？1M流量要10块钱！大家想一想，1M流量10块钱，1G流量1万块钱，你还敢用4G刷视频么？4G时代，大家刷短视频，5G时代，大家刷长视频。基于这个判断，音视频相关技术是未来几年的热点，除了抖音快手，新的现象级客户端有可能会出现。</p>
<p><strong>作为移动开发人员，如何跟上热点学习音视频技术呢？</strong></p>
<p>今天主要介绍视频入门基础知识</p>
<h1><a id="_11"></a>视频编码基础知识</h1>
<h4><a id="_13"></a>视频和图像和关系</h4>
<p>好了，刚才说了图像，现在，我们开始说视频。所谓视频，大家从小就看动画，都知道视频是怎么来的吧？没错，大量的图片连续起来，就是视频。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTZmMmIxNzJjOWUyMGJkM2QuZ2lmP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNDAwL2Zvcm1hdC93ZWJw" alt=""></p>
<p>衡量视频，又是用的什么指标参数呢？最主要的一个，就是帧率（Frame Rate）。在视频中，一个帧（Frame）就是指一幅静止的画面。帧率，就是指视频每秒钟包括的画面数量（FPS，Frame per second）。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTVkNThhNzk0N2M3YTUzNWMuZ2lmP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNTQyL2Zvcm1hdC93ZWJw" alt=""></p>
<p>帧率越高，视频就越逼真、越流畅。</p>
<h4><a id="_25"></a>未经编码的视频数据量会有多大？</h4>
<p><strong>有了视频之后，就涉及到两个问题：</strong></p>
<blockquote>
<p>一个是存储；</p>
<p>二个是传输。</p>
</blockquote>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTEwZTExODUxZmEwOTQ4NWUuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvMjkyL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>而之所以会有视频编码，关键就在于此：一个视频，如果未经编码，它的体积是非常庞大的。</p>
<p><strong>以一个分辨率1920×1280，帧率30的视频为例：</strong></p>
<blockquote>
<p>共：1920×1280=2,073,600（Pixels 像素），每个像素点是24bit（前面算过的哦）；</p>
<p>也就是：每幅图片2073600×24=49766400 bit，8 bit（位）=1 byte（字节）；</p>
<p>所以：49766400bit=6220800byte≈6.22MB。</p>
</blockquote>
<p>这是一幅1920×1280图片的原始大小，再乘以帧率30。</p>
<p>**也就是说：**每秒视频的大小是186.6MB，每分钟大约是11GB，一部90分钟的电影，约是1000GB。。。</p>
<p>吓尿了吧？就算你现在电脑硬盘是4TB的（实际也就3600GB），也放不下几部大姐姐啊！不仅要存储，还要传输，不然视频从哪来呢？如果按照100M的网速（12.5MB/s），下刚才那部电影，需要22个小时。。。再次崩溃。。。</p>
<p>正因为如此，屌丝工程师们就提出了，必须对视频进行编码。</p>
<h4><a id="_53"></a>什么是编码？</h4>
<p>**编码：**就是按指定的方法，将信息从一种形式（格式），转换成另一种形式（格式）。**视频编码：**就是将一种视频格式，转换成另一种视频格式。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWRmMmM1NTQ4ZWQ5OWFmNzAuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNTAwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>编码的终极目的，说白了，就是为了压缩。各种五花八门的视频编码方式，都是为了让视频变得体积更小，有利于存储和传输。</p>
<p><strong>我们先来看看，视频从录制到播放的整个过程，如下：</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTY2YWU5OGZmZGEwNzkyODUuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNzAwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>首先是视频采集。通常我们会使用摄像机、摄像头进行视频采集。限于篇幅，我就不打算和大家解释CCD成像原理了。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWMzZTdkOTRjM2ZmNDZjNTkuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNTAwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>采集了视频数据之后，就要进行模数转换，将模拟信号变成数字信号。其实现在很多都是摄像机（摄像头）直接输出数字信号。信号输出之后，还要进行预处理，将RGB信号变成YUV信号。</p>
<p><em><strong>前面我们介绍了RGB信号，那什么是YUV信号呢？</strong></em></p>
<p>简单来说，YUV就是另外一种颜色数字化表示方式。视频通信系统之所以要采用YUV，而不是RGB，主要是因为<strong>RGB信号不利于压缩</strong>。在YUV这种方式里面，加入了亮度这一概念。在最近十年中，视频工程师发现，眼睛对于亮和暗的分辨要比对颜色的分辨更精细一些，也就是说，人眼对色度的敏感程度要低于对亮度的敏感程度。</p>
<p>所以，工程师认为，在我们的视频存储中，没有必要存储全部颜色信号。我们可以把更多带宽留给黑—白信号（被称作“亮度”），将稍少的带宽留给彩色信号（被称作“色度”）。于是，就有了YUV。</p>
<p>YUV里面的“Y”，就是亮度（Luma），“U”和“V”则是色度（Chroma）。</p>
<p>大家偶尔会见到的Y’CbCr，也称为YUV，是YUV的压缩版本，不同之处在于Y’CbCr用于数字图像领域，YUV用于模拟信号领域，MPEG、DVD、摄像机中常说的YUV其实就是Y’CbCr。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTIxY2ZlMDc4MGRhZWQyMjEuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNjAwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt="image"></p>
<p>▲ YUV（Y’CbCr）是如何形成图像的</p>
<p>YUV码流的存储格式其实与其采样的方式密切相关。（采样，就是捕捉数据）</p>
<p><strong>主流的采样方式有三种：</strong></p>
<blockquote>
<p>1）YUV4:4:4；</p>
<p>2）YUV4:2:2；</p>
<p>3）YUV4:2:0。</p>
</blockquote>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWE1NjJhNmI1YmQ2NDY3NzcuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNTgwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt="image"></p>
<p>具体解释起来有点繁琐，大家只需记住，通常用的是YUV4:2:0的采样方式，能获得1/2的压缩率。</p>
<p>这些预处理做完之后，就是正式的编码了。</p>

<h1><a id="5_103"></a>5、视频编码的实现原理</h1>
<h4><a id="51__105"></a>5.1 视频编码技术的基本原理</h4>
<p>前面我们说了，编码就是为了压缩。要实现压缩，就要设计各种算法，将视频数据中的冗余信息去除。当你面对一张图片，或者一段视频的时候，你想一想，如果是你，你会如何进行压缩呢？</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWNlMGFlMDMyYzRkZTBjODkuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNDUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>▲ 对于新垣女神，我一bit也不舍得压缩…</p>
<p>我觉得，首先你想到的，应该是找规律。是的，寻找像素之间的相关性，还有不同时间的图像帧之间，它们的相关性。</p>
<p>**举个例子：**如果一幅图（1920×1080分辨率），全是红色的，我有没有必要说2073600次[255,0,0]？我只要说一次[255,0,0]，然后再说2073599次“同上”。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LThiNTQ2ZDlmOWYzMjI2ODcuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvMjUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>如果一段1分钟的视频，有十几秒画面是不动的，或者，有80%的图像面积，整个过程都是不变（不动）的。那么，是不是这块存储开销，就可以节约掉了？</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTkxMmMxYjJkZThlMWM0OWMuZ2lmP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNTAwL2Zvcm1hdC93ZWJw" alt=""></p>
<p>▲ 以上图为例，只有部分元素在动，大部分是不动的</p>
<p>是的，所谓编码算法，就是寻找规律，构建模型。谁能找到更精准的规律，建立更高效的模型，谁就是厉害的算法。</p>
<p><strong>通常来说，视频里面的冗余信息包括：</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTBiZTAyNTE3MjRjYjYyMzkuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNTk5L2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTk3NzFmYTQ2MWYzM2I4YjguanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNDEyL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>视频编码技术优先消除的目标，就是空间冗余和时间冗余。</p>
<p>接下来，就和大家介绍一下，究竟是采用什么样的办法，才能干掉它们。以下内容稍微有点高能，不过我相信大家耐心一些还是可以看懂的。</p>
<h4><a id="_137"></a>视频编码技术的实现方法</h4>
<p>视频是由不同的帧画面连续播放形成的。</p>
<p><strong>这些帧，主要分为三类，分别是：</strong></p>
<blockquote>
<p>1）I帧；</p>
<p>2）B帧；</p>
<p>3）P帧。</p>
</blockquote>
<p>**I帧：**是自带全部信息的独立帧，是最完整的画面（占用的空间最大），无需参考其它图像便可独立进行解码。视频序列中的第一个帧，始终都是I帧。</p>
<p><strong>P帧：</strong>“帧间预测编码帧”，需要参考前面的I帧和/或P帧的不同部分，才能进行编码。P帧对前面的P和I参考帧有依赖性。但是，P帧压缩率比较高，占用的空间较小。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTBiMGM5MGQyZTNhZTJjYWQuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvMzYwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>▲ P帧</p>
<p><strong>B帧：</strong>“双向预测编码帧”，以前帧后帧作为参考帧。不仅参考前面，还参考后面的帧，所以，它的压缩率最高，可以达到200:1。不过，因为依赖后面的帧，所以不适合实时传输（例如视频会议）。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWVhNWZhN2U2ZjJkNjU1NmQuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNDA4L2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>▲ B帧</p>
<p>通过对帧的分类处理，可以大幅压缩视频的大小。毕竟，要处理的对象，大幅减少了（从整个图像，变成图像中的一个区域）。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTdmNWQ5ZjI4MDQ5MzRlMjcuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNjAwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p><strong>如果从视频码流中抓一个包，也可以看到I帧的信息，如下：</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWM4YzZkNTkzOGNkMDU1MTEuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNzUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>我们来通过一个例子看一下。</p>
<p><strong>这有两个帧：</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTRhYzJkZGE4ODExMDk2YWUuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvODAwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>好像是一样的？</p>
<p><strong>不对，我做个GIF动图，就能看出来，是不一样的：</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWFlZTMzZDFiNTIwZDRkMDYuZ2lmP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNjQwL2Zvcm1hdC93ZWJw" alt=""></p>
<p>人在动，背景是没有在动的。</p>
<p><strong>第一帧是I帧，第二帧是P帧。两个帧之间的差值，就是如下：</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTYyYjg1MjRkYzM3NGEzM2YuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvMzUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p><strong>也就是说，图中的部分像素，进行了移动。移动轨迹如下：</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LThhMTdmYjA5NTY1ZjczYjMuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvMzUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>这个，就是运动估计和补偿。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTZhYTNkODZlOWIwYzVhYmIuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNjUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>当然了，如果总是按照像素来算，数据量会比较大，所以，一般都是把图像切割为不同的“块（Block）”或“宏块（MacroBlock）”，对它们进行计算。一个宏块一般为16像素×16像素。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWFiMjdkM2E2OTA0ZjI4N2IuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNTcxL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>▲ 将图片切割为宏块</p>
<p>好了，我来梳理一下。</p>
<p>对I帧的处理，是采用帧内编码方式，只利用本帧图像内的空间相关性。对P帧的处理，采用帧间编码（前向运动估计），同时利用空间和时间上的相关性。简单来说，采用运动补偿(motion compensation)算法来去掉冗余信息。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTkyMzJhYjI1ZWVlNGY0NTEuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNDMxL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>需要特别注意，I帧（帧内编码），虽然只有空间相关性，但整个编码过程也不简单。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWZkM2Y1N2MzM2NjYjlkOTYuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNDUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>如上图所示，整个帧内编码，还要经过DCT（离散余弦变换）、量化、编码等多个过程。限于篇幅，加之较为复杂，今天就放弃解释了。</p>
<p>那么，视频经过编码解码之后，如何衡量和评价编解码的效果呢？</p>
<p>一般来说，分为客观评价和主观评价。客观评价，就是拿数字来说话。例如计算“信噪比/峰值信噪比”。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTg5ZmY1ZjllOWZlN2VjMTguanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNjUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>信噪比的计算，我就不介绍了，丢个公式，有空可以自己慢慢研究…</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LWRkNzkwNmZhNzRiODA4NzkuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNDUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p>除了客观评价，就是主观评价了。主观评价，就是用人的主观感知直接测量，额，说人话就是——“好不好看我说了算”。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNTAwODM5LTRlOTBlNzdkMjgxM2Y0MWEuanBnP2ltYWdlTW9ncjIvYXV0by1vcmllbnQvc3RyaXB8aW1hZ2VWaWV3Mi8yL3cvNDUwL2Zvcm1hdC93ZWJw?x-oss-process=image/format,png" alt=""></p>
<p><strong>学习分享</strong></p>
<p>音视频，人工智能，这些是未来没办法阻挡的发展大趋势。我在猎聘网上看那些招聘岗位，要求精通NDK的薪资都在30-60K。追求高薪岗位的小伙伴，NDK开发一定要掌握并且去深挖。</p>
<p>题外话，虽然我在大厂工作多年，但也指导过不少同行。深知学习分享的重要性。</p>
<p>当程序员容易，当一个优秀的程序员是需要不断学习的，从初级程序员到高级程序员，从初级架构师到资深架构师，或者走向管理，从技术经理到技术总监，每个阶段都需要掌握不同的能力。早早确定自己的职业方向，才能在工作和能力提升中甩开同龄人。</p>
<p><strong>以下是今天给大家分享的一些独家干货：</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xOTk1NjEyNy0zNTBlYjRhNTAxNjlkMzg1LnBuZw?x-oss-process=image/format,png" alt=""></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xOTk1NjEyNy0wNDc5YTJiZThhYTM1OTQwLnBuZw?x-oss-process=image/format,png" alt=""></p>
<p><strong>【Android高级架构思维脑图（技能树）】</strong></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xOTk1NjEyNy1lYjllNzQ5OGY3ZTY2NDFjLnBuZw?x-oss-process=image/format,png" alt=""></p>
<p><strong>【NDK学习视频】、【NDK资料包】【私信我】查看免费领取方式！</strong></p>

                                    </div>
                <link href="https://csdnimg.cn/release/phoenix/mdeditor/markdown_views-60ecaf1f42.css" rel="stylesheet">
                                                <div class="more-toolbox">
                <div class="left-toolbox">
                    <ul class="toolbox-list">
                        
                        <li class="tool-item tool-active is-like "><a href="javascript:;"><svg class="icon" aria-hidden="true">
                            <use xlink:href="#csdnc-thumbsup"></use>
                        </svg><span class="name">点赞</span>
                        <span class="count"></span>
                        </a></li>
                        <li class="tool-item tool-active is-collection "><a href="javascript:;" data-report-click='{"mod":"popu_824"}'><svg class="icon" aria-hidden="true">
                            <use xlink:href="#icon-csdnc-Collection-G" ></use>
                        </svg><span class="name">收藏</span></a></li>
                        <li class="tool-item tool-active is-share"><a href="javascript:;" data-report-click='{"mod":"1582594662_002"}'><svg class="icon" aria-hidden="true">
                            <use xlink:href="#icon-csdnc-fenxiang"></use>
                        </svg>分享</a></li>
                        <!--打赏开始-->
                                                <!--打赏结束-->
                                                <li class="tool-item tool-more">
                            <a>
                            <svg t="1575545411852" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5717" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M179.176 499.222m-113.245 0a113.245 113.245 0 1 0 226.49 0 113.245 113.245 0 1 0-226.49 0Z" p-id="5718"></path><path d="M509.684 499.222m-113.245 0a113.245 113.245 0 1 0 226.49 0 113.245 113.245 0 1 0-226.49 0Z" p-id="5719"></path><path d="M846.175 499.222m-113.245 0a113.245 113.245 0 1 0 226.49 0 113.245 113.245 0 1 0-226.49 0Z" p-id="5720"></path></svg>
                            </a>
                            <ul class="more-box">
                                <li class="item"><a class="article-report">文章举报</a></li>
                            </ul>
                        </li>
                                            </ul>
                </div>
                            </div>
            <div class="person-messagebox">
                <div class="left-message"><a href="https://blog.csdn.net/weixin_43901866">
                    <img src="https://profile.csdnimg.cn/8/2/E/3_weixin_43901866" class="avatar_pic" username='weixin_43901866'>
                                            <img src="https://g.csdnimg.cn/static/user-reg-year/1x/1.png" class="user-years">
                                    </a></div>
                <div class="middle-message">
                                        <div class="title"><span class="tit"><a href="https://blog.csdn.net/weixin_43901866" data-report-click='{"mod":"popu_379"}' target="_blank">Android Developer</a></span>
                                            </div>
                    <div class="text"><span>发布了450 篇原创文章</span> · <span>获赞 730</span> · <span>访问量 20万+</span></div>
                </div>
                                <div class="right-message">
                                            <a href="https://bbs.csdn.net/topics/395532450" target="_blank"
                        class="btn btn-sm btn-red-hollow bt-button personal-messageboard">他的留言板
                        </a>
                                                            <a class="btn btn-sm  bt-button personal-watch" data-report-click='{"mod":"popu_379"}'>关注</a>
                                    </div>
                            </div>
                    </div>
    </article>
</div>
</div>
</body>
</html>
