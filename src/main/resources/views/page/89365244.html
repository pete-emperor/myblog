<html>
<head>
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/detail-4bfa3af0c6.min.css">
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/themes/skin3-template/skin3-template-c9d2f651cc.min.css">
<link rel="stylesheet" href="https://csdnimg.cn/public/sandalstrap/1.4/css/sandalstrap.min.css">
<link rel="stylesheet" href="https://csdnimg.cn/public/common/toolbar/content_toolbar_css/content_toolbar.css">
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/blog_code-c3a0c33d5c.css">
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/vendor/pagination/paging-e040f0c7c8.css">
<style>
        .MathJax, .MathJax_Message, .MathJax_Preview{
            display: none
        }
    </style>
</head>
<body class="nodata " > 
    <link rel="stylesheet" href="https://csdnimg.cn/public/common/toolbar/content_toolbar_css/content_toolbar.css">
    <script id="toolbar-tpl-scriptId" src="https://csdnimg.cn/public/common/toolbar/js/content_toolbar.js" type="text/javascript" domain="https://blog.csdn.net/"></script>
    <script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/blog_code-c3a0c33d5c.css">
<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/vendor/pagination/paging-e040f0c7c8.css">

<script type="text/javascript">
	var NEWS_FEED = function(){}
</script>

<link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/chart-3456820cac.css" />
<div class="main_father clearfix d-flex justify-content-center" style="height:100%;"> 
    <div class="container clearfix" id="mainBox">
        <div  class='space_container'></div>
        <main>
            <div class="blog-content-box">
    <div class="article-header-box">
        <div class="article-header">
            <div class="article-title-box">
                <h1 class="title-article">flutter尽然还能有这种操作！！！</h1>
            </div>
            <div class="article-info-box">
                <div class="article-bar-top">
                    <!--文章类型-->
                    <span class="article-type type-1 float-left">原创</span>                                                                                                                                            <a class="follow-nickName" href="https://me.csdn.net/weixin_43901866" target="_blank" rel="noopener">Android Developer</a>
                    <span class="time">最后发布于2019-04-17 21:24:49                    </span>
                    <span class="read-count">阅读数 246</span>
                    <a id='blog_detail_zk_collection' class="un-collection" data-report-click='{"mod":"popu_823"}'>
                        <svg class="icon">
                            <use xlink:href="#icon-csdnc-Collection-G" ></use>
                        </svg>
                        <span>收藏</span>
                    </a>
                                    </div>
                                <div class="up-time">发布于2019-04-17 21:24:49</div>
                <div class="slide-content-box">
                                                                                                                        <div class="article-copyright">
                        <span class="creativecommons">
                            <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"></a>
                            <span>
                                版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 BY-SA </a>版权协议，转载请附上原文出处链接和本声明。                            </span>
                            <div class="article-source-link2222">
                                本文链接：<a href="https://blog.csdn.net/weixin_43901866/article/details/89365244">https://blog.csdn.net/weixin_43901866/article/details/89365244</a>
                            </div>
                        </span> 
                        </div>
                                                                                </div>
                <div class="operating">
                                                                <a class="href-article-edit slide-toggle">展开</a>
                                    </div>
            </div>
        </div>
    </div>
    <article class="baidu_pl">
        <!--python安装手册开始-->
                <!--python安装手册结束-->
                <!--####专栏广告位图文切换开始-->
                                    <!--####专栏广告位图文切换结束-->
         <div id="article_content" class="article_content clearfix">
            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-833878f763.css" />
                            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-833878f763.css" />
                <div class="htmledit_views" id="content_views">
                                            <h3>Android开发，有些系统功能不符合我们的开发需求，可能回去看看源码，考虑怎么去覆写实现，或者考虑直接拷贝源代码，自己实现，当然如果代码依赖的很复杂，那么拷贝就不是一个明智的选择了。</h3>

<p><img alt="" class="has" src="https://upload-images.jianshu.io/upload_images/15233518-b811ac0dae7a33f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp" /></p>

<p>这个弹窗有可能你遇到过，当我们修改代码源文件的时候，androidsutido会弹出这个弹窗，给你一个提示，大多数时候我们关了这个弹窗，会当什么都没发生过，但是我们如果点下确定的，是可以改代码的，wtf！！！<br />
虽然在java这边跑的是class，但是在flutter这边，改了就会生效了！！！</p>

<h3>基于以上，flutter的一个顽疾，滑动控件(如果没有设置physics)里面子界面如果可以点击，那么父控件开始滑动式，会有一个抖动</h3>

<p><img alt="" class="has" src="https://upload-images.jianshu.io/upload_images/15233518-99029ae104e9d839?imageMogr2/auto-orient/strip%7CimageView2/2/w/320/format/webp" /></p>

<p>问题代码 在方法acceptGesture（DragGestureRecognizer）</p>

<pre class="has">
<code> _state = _DragState.accepted;
      /// 1
      final Offset delta = _pendingDragOffset;
      /// 2
      final Duration timestamp = _lastPendingEventTimestamp;
      /// 3
      _pendingDragOffset = Offset.zero;
</code></pre>

<p>当我们开始拖动的时候会执行以上代码，_pendingDragOffset 是用于判断是否开始拖动的，当 _pendingDragOffset &gt;kTouchSlop 则调用acceptGesture确认开始滑动，而这个时候 _pendingDragOffset 是 大于kTouchSlop的至少是18px，这个值的重置在3处，，而1处的delta是初始偏移值，所以导致了这个抖动 而，我们只需要把它改成</p>

<pre class="has">
<code> _state = _DragState.accepted;
      /// 1
      final Offset delta = Offset.zero;
      /// 2
      final Duration timestamp = _lastPendingEventTimestamp;
      /// 3
      _pendingDragOffset = Offset.zero;
</code></pre>

<p>也就是 delta 设置为0 就好了</p>

<p><img alt="" class="has" src="https://upload-images.jianshu.io/upload_images/15233518-ec71121d2490eb05?imageMogr2/auto-orient/strip%7CimageView2/2/w/320/format/webp" /></p>

<h3>总结</h3>

<p>对于flutter 改源码，会立即生效，即使是多人开发这个更改工作量也是很小的。而且可以直接更改系统代码！！！可以直接更改系统代码！！！可以直接更改系统代码！！！<br />
因此flutter的扩展自用度，真的难以想象，（至少在flutter底层代码没被写进Android系统前是这样的。。。）</p>

<p> </p>

<p><img alt="" class="has" src="https://upload-images.jianshu.io/upload_images/15233518-018b5f2886bc3f08.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/618/format/webp" /></p>

<blockquote>
<p>关于Flutter的全部学习内容，我们这边都有系统的知识体系以及进阶视频资料，有需要的朋友可以加群免费领取安卓进阶视频教程，源码，面试资料，群内有大牛一起交流讨论技术；<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fjq.qq.com%2F%3F_wv%3D1027%26k%3D5hJNx7n" rel="nofollow">点击链接加入群聊【腾讯@Android高级架构】</a><br />
（包括自定义控件、NDK、架构设计、混合式开发工程师(React native，Weex)、性能优化、完整商业项目开发等）</p>
</blockquote>

<p><img alt="" class="has" src="https://upload-images.jianshu.io/upload_images/15233518-e788e0db76f40b20.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp" /></p>

<p>                                                                         Android高级进阶视频教程</p>
                                    </div>
                                                <div class="more-toolbox">
                <div class="left-toolbox">
                    <ul class="toolbox-list">
                        
                        <li class="tool-item tool-active is-like "><a href="javascript:;"><svg class="icon" aria-hidden="true">
                            <use xlink:href="#csdnc-thumbsup"></use>
                        </svg><span class="name">点赞</span>
                        <span class="count"></span>
                        </a></li>
                        <li class="tool-item tool-active is-collection "><a href="javascript:;" data-report-click='{"mod":"popu_824"}'><svg class="icon" aria-hidden="true">
                            <use xlink:href="#icon-csdnc-Collection-G" ></use>
                        </svg><span class="name">收藏</span></a></li>
                        <li class="tool-item tool-active is-share"><a href="javascript:;" data-report-click='{"mod":"1582594662_002"}'><svg class="icon" aria-hidden="true">
                            <use xlink:href="#icon-csdnc-fenxiang"></use>
                        </svg>分享</a></li>
                        <!--打赏开始-->
                                                <!--打赏结束-->
                                                <li class="tool-item tool-more">
                            <a>
                            <svg t="1575545411852" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5717" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style>
</head>
<body>
<div style="width:852px;margin:0 auto;">
<div class="blog-content-box">
    <div class="article-header-box">
        <div class="article-header">
            <div class="article-title-box">
                <h1 class="title-article">flutter尽然还能有这种操作！！！</h1>
            </div>
            <div class="article-info-box">
                <div class="article-bar-top">
                    <!--文章类型-->
                    <span class="article-type type-1 float-left">原创</span>                                                                                                                                            <a class="follow-nickName" href="https://me.csdn.net/weixin_43901866" target="_blank" rel="noopener">Android Developer</a>
                    <span class="time">最后发布于2019-04-17 21:24:49                    </span>
                    <span class="read-count">阅读数 246</span>
                    <a id='blog_detail_zk_collection' class="un-collection" data-report-click='{"mod":"popu_823"}'>
                        <svg class="icon">
                            <use xlink:href="#icon-csdnc-Collection-G" ></use>
                        </svg>
                        <span>收藏</span>
                    </a>
                                    </div>
                                <div class="up-time">发布于2019-04-17 21:24:49</div>
                <div class="slide-content-box">
                                                                                                                        <div class="article-copyright">
                        <span class="creativecommons">
                            <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"></a>
                            <span>
                                版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 BY-SA </a>版权协议，转载请附上原文出处链接和本声明。                            </span>
                            <div class="article-source-link2222">
                                本文链接：<a href="https://blog.csdn.net/weixin_43901866/article/details/89365244">https://blog.csdn.net/weixin_43901866/article/details/89365244</a>
                            </div>
                        </span> 
                        </div>
                                                                                </div>
                <div class="operating">
                                                                <a class="href-article-edit slide-toggle">展开</a>
                                    </div>
            </div>
        </div>
    </div>
    <article class="baidu_pl">
        <!--python安装手册开始-->
                <!--python安装手册结束-->
                <!--####专栏广告位图文切换开始-->
                                    <!--####专栏广告位图文切换结束-->
         <div id="article_content" class="article_content clearfix">
            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-833878f763.css" />
                            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-833878f763.css" />
                <div class="htmledit_views" id="content_views">
                                            <h3>Android开发，有些系统功能不符合我们的开发需求，可能回去看看源码，考虑怎么去覆写实现，或者考虑直接拷贝源代码，自己实现，当然如果代码依赖的很复杂，那么拷贝就不是一个明智的选择了。</h3>

<p><img alt="" class="has" src="https://upload-images.jianshu.io/upload_images/15233518-b811ac0dae7a33f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp" /></p>

<p>这个弹窗有可能你遇到过，当我们修改代码源文件的时候，androidsutido会弹出这个弹窗，给你一个提示，大多数时候我们关了这个弹窗，会当什么都没发生过，但是我们如果点下确定的，是可以改代码的，wtf！！！<br />
虽然在java这边跑的是class，但是在flutter这边，改了就会生效了！！！</p>

<h3>基于以上，flutter的一个顽疾，滑动控件(如果没有设置physics)里面子界面如果可以点击，那么父控件开始滑动式，会有一个抖动</h3>

<p><img alt="" class="has" src="https://upload-images.jianshu.io/upload_images/15233518-99029ae104e9d839?imageMogr2/auto-orient/strip%7CimageView2/2/w/320/format/webp" /></p>

<p>问题代码 在方法acceptGesture（DragGestureRecognizer）</p>

<pre class="has">
<code> _state = _DragState.accepted;
      /// 1
      final Offset delta = _pendingDragOffset;
      /// 2
      final Duration timestamp = _lastPendingEventTimestamp;
      /// 3
      _pendingDragOffset = Offset.zero;
</code></pre>

<p>当我们开始拖动的时候会执行以上代码，_pendingDragOffset 是用于判断是否开始拖动的，当 _pendingDragOffset &gt;kTouchSlop 则调用acceptGesture确认开始滑动，而这个时候 _pendingDragOffset 是 大于kTouchSlop的至少是18px，这个值的重置在3处，，而1处的delta是初始偏移值，所以导致了这个抖动 而，我们只需要把它改成</p>

<pre class="has">
<code> _state = _DragState.accepted;
      /// 1
      final Offset delta = Offset.zero;
      /// 2
      final Duration timestamp = _lastPendingEventTimestamp;
      /// 3
      _pendingDragOffset = Offset.zero;
</code></pre>

<p>也就是 delta 设置为0 就好了</p>

<p><img alt="" class="has" src="https://upload-images.jianshu.io/upload_images/15233518-ec71121d2490eb05?imageMogr2/auto-orient/strip%7CimageView2/2/w/320/format/webp" /></p>

<h3>总结</h3>

<p>对于flutter 改源码，会立即生效，即使是多人开发这个更改工作量也是很小的。而且可以直接更改系统代码！！！可以直接更改系统代码！！！可以直接更改系统代码！！！<br />
因此flutter的扩展自用度，真的难以想象，（至少在flutter底层代码没被写进Android系统前是这样的。。。）</p>

<p> </p>

<p><img alt="" class="has" src="https://upload-images.jianshu.io/upload_images/15233518-018b5f2886bc3f08.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/618/format/webp" /></p>

<blockquote>
<p>关于Flutter的全部学习内容，我们这边都有系统的知识体系以及进阶视频资料，有需要的朋友可以加群免费领取安卓进阶视频教程，源码，面试资料，群内有大牛一起交流讨论技术；<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fjq.qq.com%2F%3F_wv%3D1027%26k%3D5hJNx7n" rel="nofollow">点击链接加入群聊【腾讯@Android高级架构】</a><br />
（包括自定义控件、NDK、架构设计、混合式开发工程师(React native，Weex)、性能优化、完整商业项目开发等）</p>
</blockquote>

<p><img alt="" class="has" src="https://upload-images.jianshu.io/upload_images/15233518-e788e0db76f40b20.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp" /></p>

<p>                                                                         Android高级进阶视频教程</p>
                                    </div>
                                                <div class="more-toolbox">
                <div class="left-toolbox">
                    <ul class="toolbox-list">
                        
                        <li class="tool-item tool-active is-like "><a href="javascript:;"><svg class="icon" aria-hidden="true">
                            <use xlink:href="#csdnc-thumbsup"></use>
                        </svg><span class="name">点赞</span>
                        <span class="count"></span>
                        </a></li>
                        <li class="tool-item tool-active is-collection "><a href="javascript:;" data-report-click='{"mod":"popu_824"}'><svg class="icon" aria-hidden="true">
                            <use xlink:href="#icon-csdnc-Collection-G" ></use>
                        </svg><span class="name">收藏</span></a></li>
                        <li class="tool-item tool-active is-share"><a href="javascript:;" data-report-click='{"mod":"1582594662_002"}'><svg class="icon" aria-hidden="true">
                            <use xlink:href="#icon-csdnc-fenxiang"></use>
                        </svg>分享</a></li>
                        <!--打赏开始-->
                                                <!--打赏结束-->
                                                <li class="tool-item tool-more">
                            <a>
                            <svg t="1575545411852" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5717" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M179.176 499.222m-113.245 0a113.245 113.245 0 1 0 226.49 0 113.245 113.245 0 1 0-226.49 0Z" p-id="5718"></path><path d="M509.684 499.222m-113.245 0a113.245 113.245 0 1 0 226.49 0 113.245 113.245 0 1 0-226.49 0Z" p-id="5719"></path><path d="M846.175 499.222m-113.245 0a113.245 113.245 0 1 0 226.49 0 113.245 113.245 0 1 0-226.49 0Z" p-id="5720"></path></svg>
                            </a>
                            <ul class="more-box">
                                <li class="item"><a class="article-report">文章举报</a></li>
                            </ul>
                        </li>
                                            </ul>
                </div>
                            </div>
            <div class="person-messagebox">
                <div class="left-message"><a href="https://blog.csdn.net/weixin_43901866">
                    <img src="https://profile.csdnimg.cn/8/2/E/3_weixin_43901866" class="avatar_pic" username='weixin_43901866'>
                                            <img src="https://g.csdnimg.cn/static/user-reg-year/1x/1.png" class="user-years">
                                    </a></div>
                <div class="middle-message">
                                        <div class="title"><span class="tit"><a href="https://blog.csdn.net/weixin_43901866" data-report-click='{"mod":"popu_379"}' target="_blank">Android Developer</a></span>
                                            </div>
                    <div class="text"><span>发布了450 篇原创文章</span> · <span>获赞 730</span> · <span>访问量 20万+</span></div>
                </div>
                                <div class="right-message">
                                            <a href="https://bbs.csdn.net/topics/395532450" target="_blank"
                        class="btn btn-sm btn-red-hollow bt-button personal-messageboard">他的留言板
                        </a>
                                                            <a class="btn btn-sm  bt-button personal-watch" data-report-click='{"mod":"popu_379"}'>关注</a>
                                    </div>
                            </div>
                    </div>
    </article>
</div>
</div>
</body>
</html>
